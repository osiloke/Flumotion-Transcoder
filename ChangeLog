2007-06-20  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/utils.py (resolveFailure):
	  Made the resolveFailure resolve all failure 
	  if no error type is specified.

2007-06-20  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/admintask.py (IAdminTask.isActive,
	  IAdminTask.hasTerminated):
	* flumotion/transcoder/admin/montask.py (MonitoringTask.hasTerminated,
	  MonitoringTask.__deleteMonitor):
	* flumotion/transcoder/admin/taskmanager.py
	  (TaskManager.__apartTasklessComponent,
	  TaskManager.__releaseTasklessComponent,
	  TaskManager.__cbRemoveComponent):
	  Added hasTerminated method.
	  Added some more logging.

2007-06-20  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/proxies/componentproxy.py
	  (BaseComponentProxy.__isOperationTerminated,
	  BaseComponentProxy.__asyncForceStop):
	* flumotion/transcoder/errors.py (OperationAbortedError):
	  Changed OperationAborted exception to OperationAbortedError.
	
2007-06-20  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/component/transcoder/targets.py
	  (AudioVideoTarget._sourceDiscovered):
	  Log when a input file do not have audio or video
	  stream but we tolerate it.

2007-06-20  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/transtask.py (TranscodingTask.cbGotStatus,
	  TranscodingTask.__cbSelectPotentialTranscoder):
	  Do not select as potential transcoder one taht 
	  has already been acknowledged. This to allow the transcoding
	  of a file that previously fail and for which a sad component
	  is still running.

2007-06-20  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/proxies/componentproxy.py
	  (BaseComponentProxy._getUIDictValue,
	  BaseComponentProxy.__isOperationTerminated):
	  Check for the PBConnectionLost exception.
	  Corrected a bug where the UI state waiter was used
	  insteed of the proper value, changed to use the getter.
	  
2007-06-20  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/component/transcoder/context.py (TargetContext,
	  TargetContext.shouldBeAnalyzed, TargetContext.shouldGenerateLinkFile,
	  TargetContext.shouldHaveAudio, TargetContext.shouldHaveVideo):
	* flumotion/component/transcoder/job.py
	  (TranscoderJob.__cbProcessTarget, TranscoderJob.__cbTargetIsAMedia):
	  Properly handle the verification of target files when
	  beeing tolerant.

2007-06-20  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/component/transcoder/compconsts.py:
	Added component's constants file.

2007-06-19  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/adminconsts.py:
	* flumotion/transcoder/admin/admintask.py
	  (IAdminTask.waitActiveWorker):
	* flumotion/transcoder/admin/monitoring.py
	  (Monitoring.__cbMonitorSetGoesIdle,
	  Monitoring.__cbRetrieveActiveWorker, Monitoring.__ebStartingFailure):
	* flumotion/transcoder/admin/montask.py
	  (MonitoringTask.waitActiveWorker):
	* flumotion/transcoder/admin/transcoding.py
	  (Transcoding.__cbTranscoderSetGoesIdle,
	  Transcoding.__cbRetrieveActiveWorker,
	  Transcoding.__ebStartingFailure):
	* flumotion/transcoder/admin/transtask.py
	  (TranscodingTask.waitActiveWorker,
	  TranscodingTask.onTranscoderJobStateChanged,
	  TranscodingTask.__waitPotentialTranscoder,
	  TranscodingTask.cbGotStatus, TranscodingTask.ebGetStatusError,
	  TranscodingTask.__cbSelectPotentialTranscoder,
	  TranscodingTask.__startTranscoder,
	  TranscodingTask.__ebPotentialTranscoderFailure,
	  TranscodingTask.__cbGotPotentialTranscoder,
	  TranscodingTask.__loadTranscoder):
	* flumotion/transcoder/utils.py (overrideResult, shiftResult):
	Made the active worker retrieval asynchronous to allow
	the use of UI state information during worker selection.

2007-06-19  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/proxies/componentproxy.py
	  (BaseComponentProxy._getUIDictValue):
	  For now, do not allow getting a ui state value
      if the UI state has not been retrieved
	
2007-06-19  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/proxies/componentproxy.py
	  (BaseComponentProxy._getUIDictValue,
	  BaseComponentProxy._waitUIDictValue,
	  BaseComponentProxy.__getUIDictValue):
	* flumotion/transcoder/admin/proxies/transcoderproxy.py
	  (TranscoderProxy.getTranscoderProgress,
	  TranscoderProxy.waitTranscoderProgress, TranscoderProxy.getStatus,
	  TranscoderProxy.waitStatus, TranscoderProxy.getJobState,
	  TranscoderProxy.waitJobState, TranscoderProxy.isAcknowledged,
	  TranscoderProxy.waitIsAcknowledged):
	  Added the synchronous getter too. There are usefull in the event
	  handlers where you  know the ui state is set.

2007-06-19  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/proxies/transcoderproxy.py
	  (TranscoderProxy.waitTranscoderProgress, TranscoderProxy.waitStatus,
	  TranscoderProxy.waitJobState, TranscoderProxy.waitIsAcknowledged):
	  Change getters names from getXX to waitXX because it return a deferred.

2007-06-19  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/proxies/componentproxy.py
	  (BaseComponentProxy._getUIDictValue,
	  BaseComponentProxy.__cbGetUIDictValue):
	* flumotion/transcoder/admin/proxies/transcoderproxy.py
	  (TranscoderProxy.getTranscoderProgress, TranscoderProxy.getStatus,
	  TranscoderProxy.getJobState, TranscoderProxy.isAcknowledged,
	  TranscoderProxy.getReport):
	  Change the UI State's getters to return deferred.

2007-06-19  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/component/transcoder/targets.py
	  (AudioVideoTarget._updatePipeline):
	  Corrected copy/past error.

2007-06-19  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/proxies/componentproxy.py
	  (BaseComponentProxy.retrieveUIState):
	  Made the retrieveUIState deferred return the component 
	  inplace of the state reference.

2007-06-19  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/montask.py (MonitoringTask.stop,
	  MonitoringTask.__startup, MonitoringTask.__startMonitor,
	  MonitoringTask.__cbMonitorStartSucceed,
	  MonitoringTask.__cbMonitorGoesHappy):
	* flumotion/transcoder/admin/transtask.py (TranscodingTask.stop,
	  TranscodingTask.__cbTranscoderGoesHappy):
	Corrected a bug when removeing listener, and comparing worker name.

2007-06-19  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/admin.py (TranscoderAdmin,
	  TranscoderAdmin.onMonitoredFileAdded,
	  TranscoderAdmin.onMonitoredFileRemoved,
	  TranscoderAdmin.onTranscodingTerminated):
	  Basic transcoding impelmentation without scheduling.

2007-06-19  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/proxies/groupproxy.py
	  (ComponentGroupProxy._stateAppend):
	Menor cleanup.

2007-06-19  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/proxies/componentproxy.py
	  (BaseComponentProxy.__isOperationTerminated,
	  BaseComponentProxy.__stopOrDelete,
	  BaseComponentProxy.__asyncForceStop,
	  BaseComponentProxy.__asyncForceDelete,
	  BaseComponentProxy.__asyncRetryKillIfNeeded,
	  BaseComponentProxy.__asyncForceKillFailed,
	  BaseComponentProxy.__asyncForceStopFailed,
	  BaseComponentProxy.__asyncForceDeleteFailed):
	* flumotion/transcoder/errors.py (OperationAborted,
	  OperationAborted.__init__):
	  Try to properly handle stale broker error.

2007-06-19  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/component/transcoder/transcoder.py
	  (MultiTranscoder._updateProgress):
	  Corrected a bug for when there is no sink yet.

2007-06-19  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/component/transcoder/filetranscoder.py
	  (FileTranscoderMedium.remote_acknowledge,
	  FileTranscoder.do_acknowledge, FileTranscoder.init,
	  FileTranscoder.do_setup, FileTranscoder.onAcknowledged,
	  FileTranscoder.__ebAcknowledgeError,
	  FileTranscoder.__finalizeDiagnoseMode,
	  FileTranscoder.__finalizeStandardMode):
	* flumotion/component/transcoder/job.py (TranscoderJob.acknowledge):
	Allow acknowledge method to be called more than one time.
	Some name cleanup.
	
2007-06-19  Sebastien Merle  <sebastien@fluendo.com>

	* conf/transcoder-data.ini:
	* flumotion/component/transcoder/targets.py
	  (AudioTarget._sourceDiscovered, VideoTarget._sourceDiscovered,
	  AudioVideoTarget.__init__, AudioVideoTarget._sourceDiscovered,
	  AudioVideoTarget._updatePipeline, _sourceDiscovered):
	* flumotion/transcoder/admin/datasource/dataprops.py (AudioVideoData):
	* flumotion/transcoder/admin/datasource/datasource.py
	  (IDataSource.retrieveTargetConfig):
	* flumotion/transcoder/admin/datasource/dummysource.py:
	* flumotion/transcoder/admin/datastore/configstore.py
	  (AudioVideoConfig.getTolerance):
	* flumotion/transcoder/admin/transprops.py
	  (createTranscodingConfigFromContext):
	* flumotion/transcoder/enums.py:
	* flumotion/transcoder/transconfig.py (AudioVideoConfig):
	Added a tolerence property for the Audio/Video tragets to
	be able to allow the input files without audio.

2007-06-15  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/transtask.py
	  (TranscodingTask.onTranscoderJobStateChanged):
	  Added logging of transcoder job state changes.

2007-06-15  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/component/transcoder/filetranscoder.py
	  (FileTranscoderMedium.remote_acknowledge,
	  FileTranscoder.do_acknowledge, FileTranscoder.init,
	  FileTranscoder.do_setup, FileTranscoder.onacknowledged,
	  FileTranscoder.__ebacknowledgeError,
	  FileTranscoder.__finalizeStandardMode):
	Corrected typo.
	
2007-06-15  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/log.py:
	Changed wrong WARNING to WARN.

2007-06-15  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/component/transcoder/Makefile.am:
	* flumotion/component/transcoder/base.xml:
	* flumotion/component/transcoder/filemonitor.py (FileMonitor,
	  FileMonitor.init):
	* flumotion/component/transcoder/filetranscoder.py (FileTranscoder,
	  FileTranscoder.init, FileTranscoder._logCurrentException):
	* flumotion/component/transcoder/filetranscoder.xml:
	* flumotion/component/transcoder/transcoder.py (MultiTranscoder):
	* flumotion/component/transcoder/watcher.py (Watcher):
	* flumotion/transcoder/admin/admin.py (TranscoderAdmin):
	* flumotion/transcoder/admin/datasource/dummysource.py
	  (DummyDataSource):
	* flumotion/transcoder/admin/datasource/filesource.py (FileDataSource):
	* flumotion/transcoder/admin/datasource/sqlsource.py (SQLDataSource):
	* flumotion/transcoder/admin/datastore/adminstore.py (StoreLogger):
	* flumotion/transcoder/admin/main.py (possess, exorcize, main):
	* flumotion/transcoder/admin/montask.py:
	* flumotion/transcoder/admin/proxies/managerset.py
	  (FlumotionProxiesLogger):
	* flumotion/transcoder/admin/taskmanager.py (TaskManager):
	* flumotion/transcoder/admin/transtask.py:
	* flumotion/transcoder/log.py (setDefaultCategory, log, debug, info,
	  warning, error):
	* flumotion/transcoder/process.py (Process):
	Added a constant file for the components.
	More proxying of flumotion.common.log in flumotion.transcoder.log.

2007-06-15  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/admin.py (TranscoderAdmin):
	* flumotion/transcoder/admin/adminconsts.py:
	* flumotion/transcoder/admin/datastore/adminstore.py (StoreLogger):
	* flumotion/transcoder/admin/main.py (possess, exorcize, main):
	* flumotion/transcoder/admin/monitoring.py (Monitoring):
	* flumotion/transcoder/admin/proxies/managerset.py
	  (FlumotionProxiesLogger):
	* flumotion/transcoder/admin/transcoding.py (Transcoding):
	Changed the logging categories, and centralized them in adminconsts.

2007-06-15  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/taskmanager.py (TaskManager.getLabel,
	  TaskManager.addTask, TaskManager.removeTask, TaskManager.start,
	  TaskManager.pause, TaskManager.resume, TaskManager.abort,
	  TaskManager.addComponent, TaskManager.removeComponent,
	  TaskManager.onComponentMoodChanged, TaskManager._tryStarting,
	  TaskManager.__cbAddComponent, TaskManager.__ebGetPropertiesFailed,
	  TaskManager.__ebStopFailed, TaskManager.__ebDeleteFailed,
	  TaskManager.__ebStartupFailed, TaskManager.__ebResumeFailed,
	  TaskManager.__ebPauseFailed):
	  Added a label to the task manager for better logging.

2007-06-15  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/montask.py
	  (MonitoringTask.__electMonitor):
	* flumotion/transcoder/admin/transtask.py
	  (TranscodingTask.__electTranscoder):
	Corrected get UI state callbacks parameter.

2007-06-15  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/utils.py (callWithTimeout, __ebForwardErrback,
	  __cbForwardCallback):
	  Return the correct deferred, and properly cancel the timeout.

2007-06-15  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/utils.py (__ebForwardErrback,
	  __cbForwardCallback):
	Corrected function parameter order.

2007-06-15  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/utils.py (callWithTimeout):
	Should return the new deferred.

2007-06-15  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/compprops.py:
	* flumotion/transcoder/admin/context/customercontext.py:
	* flumotion/transcoder/admin/context/profilecontext.py:
	* flumotion/transcoder/admin/context/transcontext.py:
	* flumotion/transcoder/admin/monprops.py:
	* flumotion/transcoder/admin/proxies/componentproxy.py
	  (BaseComponentProxy.kill,
	  BaseComponentProxy.__asyncRetryKillIfNeeded,
	  BaseComponentProxy.__asyncForceStopFailed,
	  BaseComponentProxy.__asyncForceDeleteFailed):
	* flumotion/transcoder/admin/proxies/groupproxy.py
	  (ComponentGroupProxy._loadComponent):
	* flumotion/transcoder/admin/proxies/monitorset.py:
	* flumotion/transcoder/admin/proxies/transcoderset.py:
	* flumotion/transcoder/admin/transprops.py:
	Corrected some import path that changed.

2007-06-14  Sebastien Merle  <sebastien@fluendo.com>
	
	* The admin can now react to monitoring event and 
	start basic transcoding tasks without acknowlegment.

2007-06-14  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/adminconsts.py: 
	* flumotion/transcoder/admin/admintask.py: 
	* flumotion/transcoder/admin/montask.py: 
	* flumotion/transcoder/admin/taskmanager.py: 
	* flumotion/transcoder/admin/transtask.py: 
	Revised transcoding task and transcoding manager.

2007-06-14  Sebastien Merle  <sebastien@fluendo.com>

	* The admin can now start transcoder components with 
	proper configuration generation, and path virtualization.

2007-06-08  Sebastien Merle  <sebastien@fluendo.com>

	* Refactoring for generic idle state detection,
	  and source cleanup.

2007-05-31  Sebastien Merle  <sebastien@fluendo.com>

	* First version with monitoring distribution.

2007-05-08  Sebastien Merle  <sebastien@fluendo.com>

	* Added monitors starting.

2007-05-07  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/component/transcoder/job.py: 
	* flumotion/component/transcoder/transcoder.py: 
	* flumotion/component/transcoder/binmaker.py:
	Applied corrections made for the old transcoder.
	Did some cleanup.	

2007-04-04  Sebastien Merle  <sebastien@fluendo.com>

	* Corrected the componenet UI to show in groud control.
	* Implemented low level loadComponent in proxies.

2007-03-28  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/properties.py:
	Corrected a bug that made multi level property lists to fail.
	* flumotion/transcoder/admin/adminconfig.py: 
	* flumotion/transcoder/admin/admin.py: 
	* flumotion/transcoder/admin/contexts/admincontext.py: 
	Made the context determine the datasource to use.
	* flumotion/transcoder/admin/datasource/filesource.py: 
	* flumotion/transcoder/admin/datasource/dataprops.py: 
	Added a basic read only file data source that read data from an INI file.

2007-03-27  Sebastien Merle  <sebastien@fluendo.com>

	* Added to each proxies a context that abstract configuration.

2007-03-27  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/proxies/atmosphereproxy.py: 
	* flumotion/transcoder/admin/proxies/flowproxy.py: 
	* flumotion/transcoder/admin/proxies/fluproxy.py: 
	* flumotion/transcoder/admin/proxies/managerproxy.py: 
	* flumotion/transcoder/admin/proxies/monitorproxy.py: 
	* flumotion/transcoder/admin/proxies/transcoderproxy.py: 
	* flumotion/transcoder/admin/proxies/workerproxy.py: 
	* flumotion/transcoder/admin/proxies/componentproxy.py: 
	Made all proxies to have a reference to there manager proxy.
	Now the componenet proxies retrieve the reference 
	to the proxy of the worker they are running.
	

2007-03-26  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/proxies/transcoderset.py: 
	* flumotion/transcoder/admin/proxies/transcoderproxy.py: 
	* flumotion/transcoder/admin/proxies/monitorset.py: 
	* flumotion/transcoder/admin/proxies/monitorproxy.py:
	Added Proxies and Sets for the transcoder componenets.
	* flumotion/transcoder/enums.py: 
	* flumotion/component/transcoder/job.py: 
	* flumotion/component/transcoder/filetranscoder.py: 
	* flumotion/component/transcoder/filemonitor.py: 
	* flumotion/component/transcoder/filemonitor_admin_gtk.py: 
	Changed more strang-as-enum to flumotion.common.enum
	* Some random refactoring...
	

2007-03-23  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/admin.py: 
	* flumotion/transcoder/admin/proxies/componentset.py: 
	* flumotion/transcoder/admin/proxies/componentproxy.py: 
	Really added the Flumotion Component Proxy and a component set.


2007-03-22  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/properties.py:
	Now properly raise AttributeError from __getattr__.
	* Added the flumotion element proxying framework.
	* Did some folder structure refactoring.
	* Broke old common.py in errors.py, enums.py and log.py

2007-03-13  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/component/transcoder/context.py: 
	Added a random number to the temporary files
	to let two task with the same input file
	to run at the same time.
	Add the PID to the report name.
	* flumotion/component/transcoder/job.py: 
	* flumotion/transcoder/jobconfig.py: 
	* flumotion/transcoder/jobreport.py: 
	Added time reporting.
	Change report-file to report-template 
	to add a custom part to the filename.
	* flumotion/transcoder/properties.py: 
	Added a datetime property.
	* flumotion/component/transcoder/filetranscoder.py: 
	Added an acknowledge step, this way zombie component
	will not move input files preventing other transcoding
	tasks for the same input file to work properly.
	The transcoding task will now move input file 
	only after acknowledgment.

2007-03-12  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/jobconfig.py: 
	* flumotion/transcoder/jobreport.py: 
	* flumotion/transcoder/properties.py: 
	* flumotion/transcoder/common.py: 
	* flumotion/component/transcoder/job.py: 
	* flumotion/component/transcoder/targets.py: 
	* flumotion/component/transcoder/filetranscoder.py: 
	* flumotion/component/transcoder/videosize.py: 
	* flumotion/component/transcoder/context.py: 
	* flumotion/component/transcoder/binmaker.py: 
	Changed all string-as-enum to flumotion.common.enum

2007-03-09  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/admin/targetstore.py: 
	* flumotion/transcoder/admin/profilestore.py: 
	* flumotion/transcoder/admin/customerstore.py: 
	* flumotion/transcoder/admin/adminstore.py: 
	* flumotion/transcoder/admin/basestore.py: 
	Removed some unused imports

2007-03-09  Sebastien Merle  <sebastien@fluendo.com>

	* Made the TranscoderError keeps information about
	what exception or failure cause it to be raised.
	Added custom getExceptionMessage and getFailureMessage
	that return more information if a TranscoderError is involved.
	Change all modules to use these new functions.
	* Created a data source interface to retrieve transcoder data
	asynchronously, and implemented a dummy data source with
	static data.
	* Created Store classes that are able to load there data from
	a specified data source and initialise asynchronously.
	These classes handle event broadcasting about customers, profiles targets
	events like addition deletion and so on.

2007-03-01  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/transcoder/jobconfig.py: 
	* flumotion/transcoder/jobreport.py: 
	* flumotion/transcoder/properties.py:
	The root property bags should now  inherite from RootPropertyBag,
	and the root bag parent is itself.
	Added a ChildDict property.
	Corrected some setup bugs to be able to directly assign a bag.

2007-03-01  Sebastien Merle  <sebastien@fluendo.com>

	* Moved LoggerProxy ans TranscoderError to flumotion/transcoder/common
	* Changed the component name to file-monitor and file-transcoder
	and changed the class names for consistency.

2007-02-28  Sebastien Merle  <sebastien@fluendo.com>

	* Deleted old transcoder files, and changed the new one 
	from flumotion/cluster/transcoder to flumotion/transcoder.
	Started the transcoder admin in flumotion/transcoder/admin
	(better that flumotion/cluster/transcoder/admin...)
	* Some minor changes and cleaning to the properties classes.

2007-02-26  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/component/transcoder/jobcomp.py: 
	* flumotion/cluster/transcoder/jobreport.py: 
	* flumotion/cluster/transcoder/jobconfig.py: 
	* flumotion/cluster/transcoder/inifile.py: 
	Change the  loading and saving of config/report to
	be extern from the properies description.
	This way The file format is independent from the 
	property objects.

2007-02-21  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/component/transcoder/reporter.py: 
	Corrected a vicious typo in CPUUsageMixin.
	Removed some unused object field initialization.
	
2007-02-21  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/component/transcoder/job.py: 
	Added the proper call to handle the CPU usage measurments.
	* flumotion/component/transcoder/reporter.py: 
	Added a class Mixin to handle usage measurments.
	Added some measurment (job, preprocess, transcoding) to Reporter,
	and some (postprocess, analyse) to TargetReporter.
	* flumotion/cluster/transcoder/jobreport.py: 
	Added a custom property to show CPU usage.
	Added some CPU usage properties to JobReport and TargetReport.
	* flumotion/cluster/transcoder/properties.py: 
	Let Fraction accept long values.

2007-02-21  Sebastien Merle  <sebastien@fluendo.com>
	* flumotion/component/transcoder/job.py: 
	Uncommented the input file moving.
	* doc/design.odt: 
	Added a short draft of design document.
	
2007-02-21  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/cluster/transcoder/pipelinecrawler.py: 
	Better handling of gstreamer internal changes when
	crawling the pipline using non-standard method.

2007-02-20  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/component/transcoder/reporter.py: 
	* flumotion/component/transcoder/context.py: 
	* flumotion/component/transcoder/jobcomp.py: 
	* flumotion/component/transcoder/job.py: 
	Refactored to make the transcoding job a lot more independent
	of the specified configuration and report. 
	Now all is encapsulated in a Context class that handle
	all the job specifics. A Reporter class has been added
	that help the filling of the report.
	This way the Job can use whatsoever kind of config 
	and report object.
	* flumotion/component/transcoder/common.py: 
	Added A logger proxy class that delegate all logging
	calls to a specified logger, and can add some custom 
	arguments to the call.
	* flumotion/cluster/transcoder/pipelinecrawler.py: 
	Filters the None elements when crawling.
	* flumotion/cluster/transcoder/jobreport.py: 
	Moved all methods to the Reporter class.
	* flumotion/cluster/transcoder/jobconfig.py: 
	Moved all methods to the Context class.

2007-02-16  Sebastien Merle  <sebastien@fluendo.com>
	* flumotion/component/transcoder/job_admin_gtk.py: 
	Cleanup stateSetitem method.

2007-02-16  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/component/transcoder/jobcomp.py: 
	Relay the transcoding job events to the UI with the uiState.
	* flumotion/component/transcoder/job.py: 
	The transcoding job now fire events.
	At creation, an event sink object can be specified 
	to receive the events.
	* flumotion/component/transcoder/job_admin_gtk.py: 
	Added a UI to the transcoding job.
	* flumotion/component/transcoder/job.py: 
	* flumotion/cluster/transcoder/jobreport.py: 
	Changed status to state and added a global status property.


2007-02-13  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/component/transcoder/transcoder.py: 
	Now call the pipeline callback when the state change to PLAY.
	Pass the transcoder targets to the pipeline callback.
	Corrected the progression handling to take the smallest position
	of the pipeline sinks.
	* flumotion/component/transcoder/thumbsink.py: 
	Changed the sink to async, added a name parameter.
	* flumotion/component/transcoder/targets.py: 
	Added a tag parameter to better name the gst elements.
	Store the encoding bins to be able to generate a report.
	* flumotion/component/transcoder/binmaker.py: 
	Added queue elements at the beginning of the encoding bins.
	* flumotion/cluster/transcoder/pipelinecrawler.py: 
	Added a generic pipeline crawler class.
	Can be used to parse a pipeline the SAX way.
	* flumotion/cluster/transcoder/jobreport.py: 
	Add pipeline information report for the source and the targets.
	Separate the audio and video tags for discover report.
	* flumotion/cluster/transcoder/properties.py: 
	Added a value dictionary property.
	* flumotion/component/transcoder/jobcomp.py: 
	* flumotion/component/transcoder/job.py: 
	More separation between component and transcoding job.

2007-02-07  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/component/transcoder/transcoder.py:
	Added progression notification.
	More exception handling within gstreamer called methods.
	* flumotion/component/transcoder/targets.py: 
	Changed the thumnailing prob methods and
	added a keyframe unit.
	* flumotion/component/transcoder/thumbsink.py: 
	Changed the base class from gst.Element to gst.BaseSink.
	* flumotion/component/transcoder/job.py: 
	Added basic progression logging.
	Test for config and report existance.
	* flumotion/cluster/transcoder/properties.py: 
	Changed the list item naming to support very large list.
	* flumotion/cluster/transcoder/jobconfig.py: 
	Added keyframe unit for thumbnailing targets.

2007-02-07  Sebastien Merle  <sebastien@fluendo.com>
	Added the project files. Was previously commited in fsp by error.

2007-02-06  Sebastien Merle  <sebastien@fluendo.com>
	* flumotion/component/transcoder/binmaker.py: 
	Added an optional parameter to the bin maker functions
	to be able to make bins without rate elementes.

2007-02-06  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/component/transcoder/binmaker.py: 
	Reverted the video boxing filling color to black.
	* flumotion/component/transcoder/thumbsink.py: 
	* flumotion/component/transcoder/targets.py: 
	Added thumbnailing target with a custom sink.

2007-02-05  Sebastien Merle  <sebastien@fluendo.com>

	* flumotion/component/transcoder/common.py: 
	* flumotion/component/transcoder/job.py: 
	* flumotion/component/transcoder/jobcomp.py: 
	Separated the transcoding job from the flumotion component.
	* All files:
	Change the headers to have correct license.
	* flumotion/cluster/transcoder/jobconfig.py: 
	Added some thumbnail configuration properties.
	
2007-02-02  Sebastien Merle  <sebastien@fluendo.com>
	First commit of the new transcoder version.

2006-11-15  Andy Wingo  <wingo@pobox.com>

	* flumotion/transcoder/job.py (Job.finish, Job.fail): _exit
	instead of exit, so as to work correctly from deferred callbacks
	and other quoi.
	(Job.finish): Thanks distributed pychecker!

2006-11-09  Andy Wingo  <wingo@pobox.com>

	* flumotion/transcoder/transcoder.py
	(JobProcessProtocol.sendMessage): Fix handling of translatables.
	Fixes #402.

2006-11-07  Andy Wingo  <wingo@pobox.com>

	* flumotion/transcoder/config.py (Profile.__init__): Don't default
	to 30 channels of audio at 30 Hz.

	* flumotion/transcoder/trans.py (MultiTranscoder._makeEncodingBin)
	(MultiTranscoder._makeAudioEncodebin)
	(MultiTranscoder._makeVideoEncodebin)
	(MultiTranscoder._makePipeline): Construct the whole pipeline at
	the beginning, only linking the tee's sinks at PAUSED.

	* conf/flumotion-transcoder-test.ini: Add another config for
	testing two-at-a-time goodness.

2006-11-07  Edward Hervey  <edward@fluendo.com>

	* flumotion/transcoder/trans.py:
	Set the maximum bytes size of decodebin's internal queues to
	10 Mbytes.

2006-11-07  Andy Wingo  <wingo@pobox.com>

	* flumotion/transcoder/job.py (Job.transcode_done): Tell the
	output discoverers whether they should expect audio and video.
	(Job.output_discovered): Consider the output a failure if e.g. we
	expected video but didn't get it. Fixes #389.

2006-11-02  Andy Wingo  <wingo@pobox.com>

	* flumotion/transcoder/transcoder.py (Transcoder.startJob): Damn
	you Mike Smith!

2006-11-02  Thomas Vander Stichele  <thomas at apestaart dot org>

	* doc/redhat/flumotion-transcoder.init:
	  daemon now removes its own pid file

2006-11-02  Andy Wingo  <wingo@pobox.com>

	* flumotion/transcoder/Makefile.am (component_PYTHON): Dist
	job.py.

	* flumotion/transcoder/transcoder.py (InputHandler): Removed, no
	longer necessary.
	(JobProcessProtocol): Implemented a process protocol for jobs.
	(Transcoder): Track watched directories directly. Use the
	JobProcessProtocol to spawn jobs, allowing us to spawn multiple
	jobs. Sort tasks using a priority queue.

	* flumotion/transcoder/main.py (main): No need to tell the
	transcoder to run.

	* flumotion/transcoder/job.py (Job.get_output_filename): Use
	getOutputBasename from the profile.
	(Job.perform_get_request): Fix pychecker-caught errors.
	(usage): Fix usage.
	(Job.output_recognized): Update to use new cortado arguments, as
	in [4354], [4355], [4356].

	* conf/flumotion-transcoder-test.ini (maxjobs): Add maxjobs to the
	example.

	* flumotion/transcoder/config.py (Profile.getOutputBasename): New
	method.
	(Customer.alreadyProcessedFiles): New method.
	(Customer.alreadyProcessedFiles.all): Pithy!
	(Config.parse): Always set default values for [global] section.

	* flumotion/test/test_transcoder_config.py
	(TestConfigParser.testParseProfile): Test getOutputBasename.

	* misc/pycheckerhelp.py: Pacify pychecker?

	* flumotion/transcoder/config.py (Config): Make a SectionParser so
	that we can handle options in [global].

	* flumotion/test/test_transcoder_config.py
	(TestConfigParser.testParseFull): Test [global] parsing, and
	parsing of entire config files.

2006-11-01  Andy Wingo  <wingo@pobox.com>

	* flumotion/transcoder/job.py (Job): Implement a job object to do
	the transcode. Makes flumotion-transcoder-job work.

2006-11-01  Michael Smith  <msmith@fluendo.com>

	* flumotion/transcoder/transcoder.py:
	  Use true/false, not 1/0, because cortado doesn't understand the
	  latter.

2006-11-01  Michael Smith  <msmith@fluendo.com>

	* flumotion/transcoder/transcoder.py:
	  Missing c- on height check.

2006-11-01  Michael Smith  <msmith@fluendo.com>

	* flumotion/transcoder/transcoder.py:
	  Use New Hotness, not Old Crapness, when generating links to
	  cortado/gatekeeper.

2006-11-01  Thomas Vander Stichele  <thomas at apestaart dot org>

	* doc/redhat/flumotion-transcoder.init:
	  remove --log property since it was removed from the program

2006-11-01  Andy Wingo  <wingo@pobox.com>

	* flumotion/transcoder/main.py (daemonizeHelper): Don't force a
	dep on new flumotion.

2006-11-01  Thomas Vander Stichele  <thomas at apestaart dot org>

	* TODO:
	  add a note
	* flumotion-transcoder.spec.in:
	  package -job

2006-11-01  Andy Wingo  <wingo@pobox.com>

	* flumotion/transcoder/trans.py (calculateOutputSize)
	(getOutputVideoCaps): Factor out of the Profile object; these are
	just functions now.
	(MultiTranscoder._discoveredCb): Hah!

	* flumotion/transcoder/config.py (Config.parse): Fix parsing of
	whole files.

	* flumotion/transcoder/transcoder.py (InputHandler): Refactor to
	use the new config interface.
	(Transcoder): Refactor to use the new config interface.

	* bin/Makefile.am (sbin_SCRIPTS): 
	* bin/flumotion-transcoder-job.in: 
	* configure.ac: s/transcode-job/transcoder-job/.

	* flumotion/transcoder/config.py (Config.parse): Make sure we
	notice errors reading the config files.

	* flumotion/transcoder/main.py (main): Use the common daemonize
	facilities. Convert to the new config interface.

	* flumotion/transcoder/job.py (main): New file, not completely
	implemented yet.

	* bin/flumotion-transcoder-job.in: New file, will be what the
	transcoder will run.

	* bin/flumotion-transcoder.in: Make more conventional.

	* flumotion/transcoder/config.py (Customer.ensureDirs): Fix error
	caught by pychecker.
	(Customer.ensureDirs): Appeasement.

	* flumotion/test/test_transcoder_config.py (TestConfigParser):
	Remove a test stub.

2006-11-01  Michael Smith  <msmith@fluendo.com>

	* conf/flumotion-transcoder-test.ini:
	  Add my test config which just writes everything under /tmp/

2006-11-01  Andy Wingo  <wingo@pobox.com>

	* flumotion/transcoder/config.py (Profile.__init__): Add
	maxheight, maxwidth, extension properties.

	* flumotion/test/test_transcoder_config.py
	(TestConfigParser.testParseProfile): Test the profile parser.

	* flumotion/transcoder/config.py (Customer.ensureDirs): Factor out
	of __init__.
	(SectionParser.parseFromTable, Customer.__init__): Fix bugs caught
	by the test suite.

	* flumotion/test/test_transcoder_config.py
	(TestConfigParser.testParseCustomer): Test the customer parser.

	* flumotion/transcoder/Makefile.am (component_PYTHON): 
	* flumotion/transcoder/config.py: Refactor the config parser.

	* configure.ac: 
	* flumotion/Makefile.am: 
	* flumotion/test/Makefile.am: 
	* flumotion/test/__init__.py: 
	* flumotion/test/common.py: 
	* flumotion/test/test_transcoder_config.py: Add trial
	infrastructure.

2006-11-01  Michael Smith  <msmith@fluendo.com>

	* flumotion/transcoder/trans.py:
	* flumotion/transcoder/transcoder.py:
	  Add maxheight, maxwidth properties; doesn't change default
	  behaviour.

2006-11-01  Michael Smith  <msmith@fluendo.com>

	* flumotion/transcoder/trans.py:
	  Calculate input display aspect ratio correctly.

2006-11-01  Andy Wingo  <wingo@pobox.com>

	* README: Write a bit.

2006-11-01  Michael Smith  <msmith@fluendo.com>

	* flumotion/transcoder/transcoder.py:
	  Delete outputting 'framerate', since it was buggy, and is no longer
	  needed.
	  Don't divide by zero. Dividing by zero isn't cool.

2006-10-25  Edward Hervey  <edward@fluendo.com>

	* conf/flumotion-transcoder.ini:
	Added two new profiles, both Mpeg4Video and Raw Audio:
	_low : no change in video format, 800kbit/s
	_high : 720x576@25fps, 2Mbit/s, GOP of 10 frames

2006-10-24  Thomas Vander Stichele  <thomas at apestaart dot org>

	* flumotion/transcoder/transcoder.py:
	  don't move to errordirectory if it is not specified
	  use os._exit() in child to make sure we get out of the reactor

2006-10-24  Thomas Vander Stichele  <thomas at apestaart dot org>

	* flumotion/transcoder/trans.py:
	  remove audiorate, as it introduces clearly audible distortion
	  in the result files, and it seems to work fine without it

2006-10-24  Thomas Vander Stichele  <thomas at apestaart dot org>

	* conf/flumotion-transcoder.ini:
	* flumotion/transcoder/transcoder.py:
	  Add a "getrequest" config parameter through which creation
	  of an output file can be announced.  Can interpolate some
	  of the values related to the outgoing file.
	  Add example config for it.

2006-10-24  Thomas Vander Stichele  <thomas at apestaart dot org>

	* bin/flumotion-transcoder.in:
	* flumotion/transcoder/main.py:
	  Use twisted harder.

2006-10-24  Edward Hervey  <edward@fluendo.com>

	* conf/flumotion-transcoder.ini:
	Added example configuration for DV in Quicktime.
	Renamed the configurations to something more sensible.

2006-10-24  Thomas Vander Stichele  <thomas at apestaart dot org>

	* bin/flumotion-transcoder.in:
	  run as a twisted app

2006-10-21  Thomas Vander Stichele  <thomas at apestaart dot org>

	* Makefile.am:
	  add pychecker target
	* flumotion/transcoder/transcoder.py:
	  fix some bugs shown by pychecker

2006-10-21  Thomas Vander Stichele  <thomas at apestaart dot org>

	* configure.ac:
	  add misc setup.py
	* doc/redhat/flumotion-transcoder.init:
	  fix it up with the new pid writing code;
	  service flumotion-transcoder restart now works
	* flumotion/transcoder/main.py:
	  write pid file
	* flumotion/transcoder/trans.py:
	  remove unused imports
	* flumotion/transcoder/transcoder.py:
	  rename TranscoderTask to InputHandler since that's what it is
	  add errordirectory and move files there that had an error when
	  transcoding
	  fork for a task
	  fix a logic error in _nextTask that made it only ever run tasks
	  for one customer
	* flumotion/transcoder/watcher.py:
	  add a FIXME about a missing method

2006-10-19  Edward Hervey  <edward@fluendo.com>

	* flumotion/transcoder/trans.py:
	Invert the order of audio filters, it is now:
	RAWAUDIO ! audiorate ! audioconvert ! audioresample ! ENCODER
	Implement queue-overrun detection system for streams that don't
	emit 'no-more-pads'

2006-10-18  Thomas Vander Stichele  <thomas at apestaart dot org>

	* flumotion/transcoder/trans.py:
	* flumotion/transcoder/transcoder.py:
	* tests/ogger.py:
	  s/audiochanns/audiochannels/g

2006-10-17  Edward Hervey  <edward@fluendo.com>

	* flumotion/transcoder/trans.py:
	Added audiochanns property to specify the number of audio channels in
	output.
	Added audiorate in the audio encoding bin.
	Set scaling method of videoscale to bilinear.
	* flumotion/transcoder/transcoder.py:
	Added reason to the error signal, adjusted emission of that signal
	accordingly.
	* flumotion/transcoder/watcher.py:
	Fix for files not present before.
	* tests/ogger.py:
	Added specific rate and channel for ogger test profile.
	* TODO:
	Extended items to do and commented others.

2006-10-16  Thomas Vander Stichele  <thomas at apestaart dot org>

	* flumotion/transcoder/transcoder.py:
	  fix cortado link

2006-10-16  Thomas Vander Stichele  <thomas at apestaart dot org>

	* Makefile.am:
	* configure.ac:
	  add tests dir to be cleaned up
	* flumotion/transcoder/trans.py:
	  add timeout param to MultiTranscoder so testing is easier
	  don't use lines longer than 80 chars

2006-10-16  Edward Hervey  <edward@fluendo.com>

	* flumotion/transcoder/trans.py:
	* flumotion/transcoder/transcoder.py:
	* flumotion/transcoder/watcher.py:
	Syntax fixes. Serialize state_change and signal emissions in
	main thread.

2006-10-16  Edward Hervey  <edward@fluendo.com>

	* flumotion/transcoder/Makefile.am:
	* flumotion/transcoder/watcher.py:
	New Watcher class with two subclasses:
	DirectoryWatcher to watch a directory
	FilesWatcher to watch a series of files
	* flumotion/transcoder/trans.py:
	Use the FilesWatcher to figure out when a Pipeline is no longer
	outputting data (deadlocked?) and report the error.
	If the discoverer reports a file isn't a media file, include the
	discovered mimetypes in the logs.
	* flumotion/transcoder/transcoder.py:
	Use the DirectoryWatcher from watcher.py
	small fixes.

2006-10-16  Edward Hervey  <edward@fluendo.com>

	* flumotion/transcoder/trans.py:
	(_decodebinNoMorePadsCb): handle case where decodebin emits
	'no-more-pads' more than once. Make sure we don't connect pads to
	non-existent bins.
	(_buildEncodingBin): Don't create audio (or video) bin if the source
	media doesn't have audio (or video). Don't put a time limit on the
	pre-encoder queues.

2006-10-15  Thomas Vander Stichele  <thomas at apestaart dot org>

	* TODO:
	  add things to work on
	* flumotion/transcoder/trans.py:
	* flumotion/transcoder/transcoder.py:
	  make the transcoder daemon use the factored-out
	  MultiTranscoder object
	  Clean up output, variable names, logging, ...

2006-10-15  Thomas Vander Stichele  <thomas at apestaart dot org>

	* flumotion/transcoder/trans.py:
	* tests/ogger.py:
	  further cleanups
	  handle non-existing files

2006-10-15  Thomas Vander Stichele  <thomas at apestaart dot org>

	* flumotion/transcoder/trans.py:
	  further cleanups, now has a MultiTranscoder separated out
	  that we can test standalone
	* tests/ogger.py:
	  fix up test for standalone MultiTranscoder

2006-10-13  Thomas Vander Stichele  <thomas at apestaart dot org>

	* flumotion-transcoder.spec.in:
	  add dep
	* flumotion/transcoder/transcoder.py:
	  write out a full iframe line
	  round up width and height of applet to multiple of 16

2006-10-13  Thomas Vander Stichele  <thomas at apestaart dot org>

	* flumotion/transcoder/transcoder.py:
	  remove prints, clean up logging a little

2006-10-13  Thomas Vander Stichele  <thomas at apestaart dot org>

	* conf/flumotion-transcoder.ini:
	* flumotion/transcoder/main.py:
	* flumotion/transcoder/transcoder.py:
	  add discovery of transcoded files
	  add generation of .link files for .ogg files that can be served
	  by cortado

2006-10-12  Thomas Vander Stichele  <thomas at apestaart dot org>

	* Makefile.am:
	* transcoder/Makefile.am:
	  pass distcheck

2006-10-12  Thomas Vander Stichele  <thomas at apestaart dot org>

	* Makefile.am:
	* configure.ac:
	* doc/redhat/flutterd.init:
	* doc/redhat/flutterd.sysconfig:
	* flutter.spec.in:
	  rename to flumotion-transcoder

2006-10-12  Thomas Vander Stichele  <thomas at apestaart dot org>

	* bin/Makefile.am:
	* bin/flumotion-transcoder.in:
	* configure.ac:
	* flumotion/__init__.py:
	* flumotion/transcoder/__init__.py:
	* flumotion/transcoder/main.py:
	* flumotion/transcoder/transcoder.py:
	  split out file in modules and a simple script that boots into them

2006-10-12  Thomas Vander Stichele  <thomas at apestaart dot org>

	* configure.ac:
	  check for Flumotion
	* bin/flutterd:
	  use flumotion logging
	  add daemonize and options parsing

2006-10-12  Thomas Vander Stichele  <thomas at apestaart dot org>

	* configure.ac:
	* misc/preamble.py:
	  turn into a flumotion project

2006-10-12  Thomas Vander Stichele  <thomas at apestaart dot org>

	* bin/flutterd:
	  make documentation and comments respect 80 character width
	  add/fix up logging so the log says something useful

2006-10-12  Thomas Vander Stichele  <thomas at apestaart dot org>

	* bin/flutterd:
	  remove print's that should not be there
	* configure.ac:
	  remove check for python headers
	* flutter.spec.in:
	  add buildrequires

2006-10-06  Edward Hervey  <edward@fluendo.com>

	* bin/flutterd:
	Implemented code to create proper video caps depending on:
	_input width, height and pixel-aspect-ratio
	_configured width and/or height and/or pixel-aspect-ratio
	_configured framerate

2006-10-05  Thomas Vander Stichele  <thomas at apestaart dot org>

	* conf/flutterd.ini:
	* flutter.spec.in:
	* test.ini:
	  update spec file and config

2006-10-05  Thomas Vander Stichele  <thomas at apestaart dot org>

	* doc/redhat/flutterd.init:
	* doc/redhat/flutterd.sysconfig:
	* flutter.spec.in:
	* misc/Makefile.am:
	* misc/preamble.py:
	  more autotools goodness

2006-10-05  Thomas Vander Stichele  <thomas at apestaart dot org>

	* LICENSE.Flumotion:
	* Makefile.am:
	* autogen.sh:
	* bin/Makefile.am:
	* configure.ac:
	* flutterd:
	  adding autotools spread

2006-10-05  Edward Hervey  <edward@fluendo.com>

	* flutrans.py:
	* test.ini:
	Initial revision of the Fluendo Transcoding Daemon
